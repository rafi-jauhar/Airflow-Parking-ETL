[2024-10-29 02:24:46,013] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: parking_pipeline.transform_data scheduled__2024-10-29T02:22:36.903345+00:00 [queued]>
[2024-10-29 02:24:46,030] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: parking_pipeline.transform_data scheduled__2024-10-29T02:22:36.903345+00:00 [queued]>
[2024-10-29 02:24:46,031] {taskinstance.py:1356} INFO - 
--------------------------------------------------------------------------------
[2024-10-29 02:24:46,032] {taskinstance.py:1357} INFO - Starting attempt 1 of 2
[2024-10-29 02:24:46,033] {taskinstance.py:1358} INFO - 
--------------------------------------------------------------------------------
[2024-10-29 02:24:46,054] {taskinstance.py:1377} INFO - Executing <Task(PythonOperator): transform_data> on 2024-10-29 02:22:36.903345+00:00
[2024-10-29 02:24:46,062] {standard_task_runner.py:52} INFO - Started process 229 to run task
[2024-10-29 02:24:46,065] {standard_task_runner.py:79} INFO - Running: ['***', 'tasks', 'run', 'parking_pipeline', 'transform_data', 'scheduled__2024-10-29T02:22:36.903345+00:00', '--job-id', '469', '--raw', '--subdir', 'DAGS_FOLDER/parking_dag.py', '--cfg-path', '/tmp/tmpxt_28k9c', '--error-file', '/tmp/tmp7wy2mr_2']
[2024-10-29 02:24:46,067] {standard_task_runner.py:80} INFO - Job 469: Subtask transform_data
[2024-10-29 02:24:46,141] {task_command.py:369} INFO - Running <TaskInstance: parking_pipeline.transform_data scheduled__2024-10-29T02:22:36.903345+00:00 [running]> on host 34572bdb7b7c
[2024-10-29 02:24:46,241] {taskinstance.py:1571} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=Airflow
AIRFLOW_CTX_DAG_ID=parking_pipeline
AIRFLOW_CTX_TASK_ID=transform_data
AIRFLOW_CTX_EXECUTION_DATE=2024-10-29T02:22:36.903345+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2024-10-29T02:22:36.903345+00:00
[2024-10-29 02:24:46,285] {python.py:173} INFO - Done. Returned value was:                                        startDtm  ...      metroAreaName
parkingTransactionKey                            ...                   
1                      2015-12-31T17:46:32.000Z  ...       Crystal City
7                      2015-12-31T17:33:51.000Z  ...          Clarendon
8                      2015-12-31T17:12:10.000Z  ...           Ballston
12                     2015-12-31T17:03:07.000Z  ...        Shirlington
15                     2015-12-31T16:53:11.000Z  ...        Shirlington
16                     2015-12-31T16:47:10.000Z  ...         Courthouse
17                     2015-12-31T16:46:52.000Z  ...         Courthouse
23                     2015-12-31T16:23:19.000Z  ...            Rosslyn
28                     2015-12-31T16:00:32.000Z  ...         Courthouse
32                     2015-12-31T15:47:48.000Z  ...        Shirlington
34                     2015-12-31T15:33:18.000Z  ...            Rosslyn
37                     2015-12-31T15:22:54.000Z  ...         Courthouse
38                     2015-12-31T15:12:49.000Z  ...       Crystal City
43                     2015-12-31T14:55:53.000Z  ...            Rosslyn
46                     2015-12-31T14:48:02.000Z  ...         Courthouse
48                     2015-12-31T14:43:40.000Z  ...            Rosslyn
53                     2015-12-31T14:13:02.000Z  ...       Crystal City
54                     2015-12-31T14:06:59.000Z  ...         Courthouse
3                      2015-12-31T17:40:58.000Z  ...    Virginia Square
10                     2015-12-31T17:03:31.000Z  ...        Shirlington
13                     2015-12-31T16:59:34.000Z  ...           Ballston
14                     2015-12-31T16:57:39.000Z  ...       Crystal City
18                     2015-12-31T16:39:24.000Z  ...            Rosslyn
20                     2015-12-31T16:36:54.000Z  ...            Rosslyn
26                     2015-12-31T16:00:49.000Z  ...         Courthouse
29                     2015-12-31T16:00:22.000Z  ...            Rosslyn
30                     2015-12-31T15:53:29.000Z  ...            Rosslyn
31                     2015-12-31T15:48:43.000Z  ...           Ballston
42                     2015-12-31T14:58:44.000Z  ...         Courthouse
44                     2015-12-31T14:52:05.000Z  ...            Rosslyn
45                     2015-12-31T14:50:41.000Z  ...         Courthouse
50                     2015-12-31T14:26:41.000Z  ...           Ballston
58                     2015-12-31T14:00:08.000Z  ...         Courthouse
61                     2015-12-31T13:50:46.000Z  ...            Rosslyn
63                     2015-12-31T13:49:21.000Z  ...         Courthouse
66                     2015-12-31T13:31:07.000Z  ...               None
55                     2015-12-31T14:06:31.000Z  ...         Courthouse
59                     2015-12-31T13:59:49.000Z  ...            Rosslyn
67                     2015-12-31T13:29:43.000Z  ...         Courthouse
68                     2015-12-31T13:29:28.000Z  ...         Courthouse
79                     2015-12-31T12:59:50.000Z  ...        Shirlington
90                     2015-12-31T12:18:43.000Z  ...          Clarendon
91                     2015-12-31T12:18:35.000Z  ...          Clarendon
92                     2015-12-31T12:18:25.000Z  ...          Clarendon
93                     2015-12-31T12:18:14.000Z  ...            Rosslyn
96                     2015-12-31T12:11:25.000Z  ...         Courthouse
106                    2015-12-31T11:52:54.000Z  ...  Virginia Hospital
107                    2015-12-31T11:52:44.000Z  ...  Virginia Hospital
109                    2015-12-31T11:48:16.000Z  ...  Virginia Hospital
117                    2015-12-31T11:19:55.000Z  ...       Crystal City

[50 rows x 10 columns]
[2024-10-29 02:24:46,369] {xcom.py:585} ERROR - Could not serialize the XCom value into JSON. If you are using pickle instead of JSON for XCom, then you need to enable pickle support for XCom in your *** config.
[2024-10-29 02:24:46,371] {taskinstance.py:1889} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 68, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 2380, in xcom_push
    session=session,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 68, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/xcom.py", line 197, in set
    map_index=map_index,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/xcom.py", line 582, in serialize_value
    return json.dumps(value).encode('UTF-8')
  File "/usr/local/lib/python3.7/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
  File "/usr/local/lib/python3.7/json/encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/usr/local/lib/python3.7/json/encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
  File "/usr/local/lib/python3.7/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type DataFrame is not JSON serializable
[2024-10-29 02:24:46,385] {taskinstance.py:1400} INFO - Marking task as UP_FOR_RETRY. dag_id=parking_pipeline, task_id=transform_data, execution_date=20241029T022236, start_date=20241029T022446, end_date=20241029T022446
[2024-10-29 02:24:46,405] {standard_task_runner.py:97} ERROR - Failed to execute job 469 for task transform_data (Object of type DataFrame is not JSON serializable; 229)
[2024-10-29 02:24:46,439] {local_task_job.py:156} INFO - Task exited with return code 1
[2024-10-29 02:24:46,495] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
